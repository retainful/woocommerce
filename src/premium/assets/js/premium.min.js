"use strict";var __assign=(this&&this.__assign)||function(){__assign=Object.assign||function(b){for(var c,a=1,e=arguments.length;a<e;a++){c=arguments[a];for(var d in c){if(Object.prototype.hasOwnProperty.call(c,d)){b[d]=c[d]}}}return b};return __assign.apply(this,arguments)};(function(a){if(typeof module==="object"&&typeof module.exports==="object"){a(require("jquery"),window,document)}else{a(jQuery,window,document)}}(function(d,c,a,e){function b(){this.settings={};this.default_ei_popup_settings={enable:"no"};this.default_atc_popup_settings={enable:"no",custom_classes:""};this.default_ct_settings={enable:"no"}}b.prototype.is_local_storage_supported=function(){try{sessionStorage.setItem("retainful","test");sessionStorage.removeItem("retainful");localStorage.setItem("retainful","test");localStorage.removeItem("retainful");return true}catch(f){return false}};b.prototype.modal=function(g,f){if(g===void 0){g=""}if(f===void 0){f="atc"}d(a).trigger("before_rnoc_show_modal");var h=d('<div class="rnoc-modal" id="rnoc-modal-'+f+'"><div class="rnoc-modal-container"><a href="#" class="rnoc-close-modal rnoc-close-modal-'+f+'" data-close="'+f+'">Close</a> '+g+"</div></div>");d("body").append(h);h.show();d(a).trigger("before_rnoc_show_modal",f);h.on("click",".rnoc-close-modal-"+f,function(){d(a).trigger("before_rnoc_close_modal_"+f+"_by_btn_click",d(this));h.remove();return false})};b.prototype.close_modal=function(f){if(f===void 0){f="atc"}var g=d(".rnoc-close-modal-"+f);d(a).trigger("before_rnoc_close_modal_"+f,g);d("#rnoc-modal-"+f).remove();return false};b.prototype.init_coupon_timer=function(k){var i=__assign(__assign({},this.default_ct_settings),k);var l=function(q,r,n,u,s,o,t){var v=q.message;var m=q.timer;var p=m.replace("{{seconds}}",t).replace("{{minutes}}",o).replace("{{hours}}",s).replace("{{days}}",u);return v.replace("{{coupon_code}}",'<span class="timer-coupon-code-'+r+'" style="color: '+q.coupon_code_color+'">'+n+"</span>").replace("{{coupon_timer}}",'<span id="rnoc-coupon-timer-'+r+'" style="color: '+q.coupon_timer_color+'">'+p+"</span>")};var f=function(q,p){var o="";if(p.enable_cta==="yes"){o='<a href="'+p.checkout_url+'" style="text-decoration:none;padding: 10px;color: '+p.cta_color+";background-color: "+p.cta_background+'">'+p.cta_text+"</a>"}var r='<div class="rnoc-coupon-timer-container-top" style="'+p.display_on+":0;background-color:"+p.background+";color:"+p.color+';">'+q+o+"</div>";d(".rnoc-coupon-timer-container-top").remove();var m=d("body");m.prepend(r);var n=d(".rnoc-coupon-timer-container-top")[0];m.css("margin-"+p.display_on,n.offsetHeight)};var g=function(q,p){var o="";if(p.enable_cta==="yes"){o='<a href="'+p.checkout_url+'" style="text-decoration:none;padding: 10px;color: '+p.cta_color+";background-color: "+p.cta_background+'">'+p.cta_text+"</a>"}var n='<div class="rnoc-coupon-timer-container-above_cart" style="background-color:'+p.background+";color:"+p.color+';">'+q+o+"</div>";var m=d(".rnoc_before_cart_container");m.html(n)};var h=function(q,p,o){var n='<div class="rnoc-coupon-timer-container-below_discount" style="background-color:'+o.background+";color:"+o.color+';">'+p+"</div>";var m=d(".rnoc-below-discount_container-"+q);m.html(n)};var j=function(){var o=sessionStorage.getItem("rnoc_coupon_timer_started");if(parseInt(i.timer_reset)===1){o=new Date().getTime();sessionStorage.setItem("rnoc_coupon_timer_started",o.toString());sessionStorage.removeItem("rnoc_timer_expired_message_shown");d.post(i.reset_url,function(s,r){})}if(o===null||o===e){o=new Date().getTime();sessionStorage.setItem("rnoc_coupon_timer_started",o.toString())}else{o=parseInt(o)}var m=parseInt(i.time_in_minutes)*60000;var q=o+m;var n=i.code;if(n!==""){n=atob(n)}var p=setInterval(function(){var t=new Date().getTime();var s=q-t;var z=Math.floor(s/(1000*60*60*24));var w=Math.floor((s%(1000*60*60*24))/(1000*60*60));var v=Math.floor((s%(1000*60*60))/(1000*60));var x=Math.floor((s%(1000*60))/1000);if(s>0){if(i.top.enable==="yes"){var A=l(i.top,"top",n,z,w,v,x);f(A,i.top)}if(i.above_cart.enable==="yes"){var u=l(i.above_cart,"above_cart",n,z,w,v,x);g(u,i.above_cart)}if(i.below_discount.enable==="yes"){var y=l(i.below_discount,"below_discount",n,z,w,v,x);h(n,y,i.below_discount)}}else{clearInterval(p);var r=localStorage.getItem("rnoc_timer_expired_message_shown");if(r===e||r===null||parseInt(r)!==1){d.post(i.expiry_url,function(D,B){if(D.success){d(".rnoc-coupon-timer-container-top").remove();d(".rnoc-coupon-timer-container-above_cart").remove();d(".rnoc-coupon-timer-container-below_discount").remove();var E=d(".coupon-"+n.toLowerCase());E.hide();var F=d(".woocommerce-notices-wrapper");var C='<ul class="woocommerce-error" role="alert"><li>'+i.expiry_message+"</li></ul>";F.append(C)}});localStorage.setItem("rnoc_timer_expired_message_shown","1")}}},1000)};if(i.enable==="yes"){if(parseInt(i.timer_started)===1){j()}d(a).on("added_to_cart",function(o,n,m){j()})}};b.prototype.show_instant_popup=function(){var g=sessionStorage.getItem("rnoc_instant_coupon_is_redirected");if(g&&g==="no"){var f=sessionStorage.getItem("rnoc_instant_coupon_popup_redirect");sessionStorage.setItem("rnoc_instant_coupon_is_redirected","yes");c.location.href=f}var h=sessionStorage.getItem("rnoc_instant_coupon_popup_showed");if(h&&h==="no"){var i=sessionStorage.getItem("rnoc_instant_coupon_popup_html");c.retainful.modal(i,"atcip");sessionStorage.setItem("rnoc_instant_coupon_popup_showed","yes")}};b.prototype.init_atc_popup=function(k){var g=__assign(__assign({},this.default_atc_popup_settings),k);var l=function(){if(g.enable==="yes"){if(sessionStorage.getItem("retainful_add_to_cart_popup_temporary_silent")==="1"){sessionStorage.removeItem("retainful_add_to_cart_popup_temporary_silent");return false}var o=sessionStorage.getItem("retainful_add_to_cart_popup_closed_by");if(o==="1"){return false}if(o===null){return true}var n=true;switch(g.show_popup_until){default:case"1":n=(o!=="1");break;case"2":n=(o!=="2");break;case"3":n=(o!=="3");break}return n}};var f=function(n){d(a).trigger("retainful_showing_add_to_cart_popup",[n]);n.removeClass("loading");n.addClass("rnoc-popup-opener");var o=d(".atc-popup-content").html();c.retainful.modal('<div id="rnoc-add-to-cart-add-on">'+o+"</div>");sessionStorage.setItem("retainful_add_to_cart_opened","yes");d(a).trigger("retainful_showed_add_to_cart_popup",[n])};d(".ajax_add_to_cart,.single_add_to_cart_button "+g.custom_classes).on("click",function(p){if(l()&&d(this).hasClass("disabled")===false&&d(this).hasClass("acbwm-atcp-allow-click")===false){p.preventDefault();f(d(this));return false}else{var o=localStorage.getItem("rnoc_atcp_data");if(o!==null&&typeof o!=="undefined"&&o!==""){var n='<input type="hidden" name="rnoc_email_popup" value="'+o+'" />';d(this).after(n);localStorage.removeItem("rnoc_atcp_data")}}});d(a).on("before_rnoc_close_modal_atc_by_btn_click",function(){j("3")});d(a).on("added_to_cart",function(p,o,n){c.retainful.show_instant_popup()});d(a).on("click","#rnoc-add-to-cart-add-on .no-thanks-close-popup",function(n){n.preventDefault();j("2")});d(a).on("click","#rnoc-add-to-cart-add-on .rnoc-popup-btn",function(p){var o=d("#rnoc-add-to-cart-add-on #rnoc-popup-email-field").val();var n=d("#rnoc-add-to-cart-add-on  #rnoc-invalid-mail-message");var q=d("#rnoc-add-to-cart-add-on #rnoc-popup-buyer-accepts-marketing");i(o,q,d("#rnoc-add-to-cart-add-on .rnoc-popup-btn"),p,n)});var i=function(r,t,o,s,n){s.preventDefault();n.hide();if(g.is_email_mandatory==="yes"&&r===""){n.show();return{error:true}}if(!m(r)){n.show();return{error:true}}else{o.addClass("loading");o.attr("disabled",true);var q={local_storage:true,email:r,is_buyer_accepting_marketing:(t.is(":checked"))?1:0,action:"set_rnoc_guest_session"};localStorage.setItem("rnoc_atcp_data",r);var p=h(q);if(!p.error){if(p.message!==""){}if(p.redirect!==null){sessionStorage.setItem("rnoc_instant_coupon_popup_redirect",p.redirect);sessionStorage.setItem("rnoc_instant_coupon_is_redirected","no")}if(p.show_coupon_instant_popup){sessionStorage.setItem("rnoc_instant_coupon_popup_showed","no");sessionStorage.setItem("rnoc_instant_coupon_popup_html",p.coupon_instant_popup_content)}sessionStorage.setItem("rnocp_is_add_to_cart_popup_email_entered","1");j("1")}else{if(p.message!==""){}}o.removeClass("loading");o.attr("disabled",false);return{error:false}}};var h=function(n,r,q,s,o){if(n===void 0){n={}}if(r===void 0){r={}}if(q===void 0){q="json"}if(s===void 0){s="POST"}if(o===void 0){o=false}var p=null;d.ajax({url:g.ajax_url,headers:r,method:s,dataType:q,data:n,async:o,success:function(t){p=t},error:function(t){p=t}});return p};var j=function(p){if(p===void 0){p="1"}sessionStorage.setItem("retainful_add_to_cart_popup_closed_by",p);var o=d("rnoc-add-to-cart-add-on");d(a).trigger("retainful_closing_add_to_cart_popup",[o]);var n=d(".rnoc-popup-opener");if(p==="1"||p==="2"){sessionStorage.setItem("retainful_add_to_cart_popup_temporary_silent","1");n.click()}else{if(g.close_btn_behavior!=="just_close"){sessionStorage.setItem("retainful_add_to_cart_popup_temporary_silent","1");n.click()}}n.attr("disabled",false);n.removeClass("rnoc-popup-opener");if(p!=="3"){c.retainful.close_modal()}d(a).trigger("retainful_closed_add_to_cart_popup",[o])};var m=function(n){var o=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return o.test(n)}};b.prototype.init_ei_popup=function(i){c.rnoc_ei_popup_showed_for=0;c.rnoc_ei_popup_is_active=false;c.is_rnoc_mobil_scroll_popup_showed=false;var g=__assign(__assign({},this.default_ei_popup_settings),i);var j=function(){return(screen.width<768)};var h=function(){var o=d(c).height();var n=d(a).height();var m=d(c).scrollTop();var l=n-o;return Math.floor(m/l*100)};var k=function(l){var m=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return m.test(l)};var f=function(){var n;for(var p in sessionStorage){if(sessionStorage.hasOwnProperty(p)){if(p.indexOf("wc_cart_hash_")===0){n=sessionStorage.getItem(p);break}}}var m=d("form.checkout");if(m.is(".processing")){return false}if(n!==""&&n!==e&&n!==null){var l=false;switch(g.show_for){default:case"all":l=true;break;case"guest":l=(g.is_user_logged_in==="no");break;case"non_email_users":var r=sessionStorage.getItem("rnocp_is_add_to_cart_popup_email_entered");l=(typeof r!=="undefined"||parseInt(r)===0);break}switch(g.show_popup){default:case"every_time_on_customer_exists":l=true;break;case"once_per_page":l=(c.rnoc_ei_popup_showed_for<=1);break;case"show_x_times_per_page":l=(c.rnoc_ei_popup_showed_for<=parseInt(g.number_of_times_per_page));break;case"once_per_session":var s=sessionStorage.getItem("rnoc_ei_popup_showed_count");l=(typeof s!="undefined");break}switch(g.show_once_its_coupon_applied){default:case"yes":l=true;break;case"no":var q=g.coupon_code;if(d("tr.cart-discount.coupon-"+q.toLowerCase()).length>0){l=false}if(d("tr.cart-discount.coupon-"+q.toUpperCase()).length>0){l=false}break}if(l){if(c.rnoc_ei_popup_is_active===false){var o=d(".rnoc-ei-popup").html();c.retainful.modal(o,"ei");c.rnoc_ei_popup_is_active=true;sessionStorage.setItem("rnoc_ei_popup_showed_count","1");c.rnoc_ei_popup_showed_for++}}else{return false}}};if(g.enable==="yes"){d(a).on("before_rnoc_close_modal_ei_by_btn_click",function(){c.rnoc_ei_popup_is_active=false});d(a).on("submit","#rnoc_exit_intent_popup_form",function(p){p.preventDefault();var n=d(this).find(".rnoc-exit-intent-popup-submit-button");var o=d(this).find("#rnoc-invalid-mail-message-exit-intent");var m=d(this).find("#rnoc-exit-intent-popup-email-field");console.log(m.val());var q=d("#rnoc-exit-intent-popup-buyer-accepts-marketing");o.hide();if(!k(m.val())||m.val()===""){o.show();return false}n.addClass("loading");n.attr("disabled",true);var l={email:m.val(),is_buyer_accepting_marketing:(q.is(":checked"))?1:0,action:"set_rnoc_exit_intent_popup_guest_session"};d.post(g.ajax_url,l,function(r){if(r.error===false){sessionStorage.setItem("rnocp_is_add_to_cart_popup_email_entered","1");if(r.message!==""){alert(r.message)}c.retainful.close_modal();if(r.redirect){c.location.href=r.redirect}}else{if(r.message!==""){alert(r.message)}}n.removeClass("loading");n.attr("disabled",false)})});d(a).on("mouseleave",function(l){if(l.clientY<0){f()}});if(j()){if(g.mobile.time_delay==="yes"&&parseInt(g.mobile.delay)>0){setTimeout(function(){f()},parseInt(g.mobile.delay)*1000)}if(g.mobile.scroll_distance==="yes"&&parseInt(g.mobile.distance)>0){d(c).on("scroll",function(){var l=h();if((l>g.mobile.distance)&&c.is_rnoc_mobil_scroll_popup_showed===false){c.is_rnoc_mobil_scroll_popup_showed=true;f()}})}}}};c.retainful=new b();if(c.retainful.is_local_storage_supported()){d(a).ready(function(){try{c.retainful.init_ei_popup(rnoc_premium_ei_popup)}catch(f){}try{c.retainful.init_coupon_timer(rnoc_premium_ct)}catch(f){}try{c.retainful.init_atc_popup(rnoc_premium_atcp)}catch(f){}c.retainful.show_instant_popup()})}}));