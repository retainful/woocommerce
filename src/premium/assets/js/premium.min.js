"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var o,t=1,r=arguments.length;t<r;t++)for(var n in o=arguments[t])Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);return e}).apply(this,arguments)};!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(e,o,t,r){function n(){this.settings={},this.default_ei_popup_settings={enable:"no"},this.default_atc_popup_settings={enable:"no",custom_classes:""},this.default_ct_settings={enable:"yes",timer_started:"0",time_in_minutes:"15",code:"",expiry_url:"",reset_url:"",expiry_message:"",expired_text:"Expired",timer_reset:"0",top:{enable:"yes",checkout_url:"",message:"Make purchase quickly, your {{coupon_code}} will expire within {{coupon_timer}}",timer:"{{minutes}}M {{seconds}}S",display_on:"bottom",background:"#ffffff",color:"#000000",coupon_code_color:"#000000",coupon_timer_color:"#000000",enable_cta:"yes",cta_text:"Checkout Now",cta_color:"#ffffff",cta_background:"#f27052"},above_cart:{enable:"no"},below_discount:{enable:"no"}}}n.prototype.is_local_storage_supported=function(){try{return sessionStorage.setItem("retainful","test"),sessionStorage.removeItem("retainful"),localStorage.setItem("retainful","test"),localStorage.removeItem("retainful"),!0}catch(e){return!1}},n.prototype.modal=function(o,r){void 0===o&&(o=""),void 0===r&&(r="atc"),e(t).trigger("before_rnoc_show_modal");var n=e('<div class="rnoc-modal" id="rnoc-modal-'+r+'"><div class="rnoc-modal-container"><a href="#0" class="rnoc-close-modal rnoc-close-modal-'+r+'" data-close="'+r+'">Close</a> '+o+"</div></div>");e("body").append(n),n.show(),e(t).trigger("before_rnoc_show_modal",r),n.on("click",".rnoc-close-modal-"+r,function(){e(t).trigger("before_rnoc_close_modal_"+r+"_by_btn_click",e(this)),n.remove()})},n.prototype.close_modal=function(o){void 0===o&&(o="atc");var r=e(".rnoc-close-modal-"+o);e(t).trigger("before_rnoc_close_modal_"+o,r),e("#rnoc-modal-"+o).remove()},n.prototype.init_coupon_timer=function(o){var n=__assign(__assign({},this.default_ct_settings),o),a=function(e,o,t,r,n,a,s){var i=e.message,c=e.timer.replace("{{seconds}}",s).replace("{{minutes}}",a).replace("{{hours}}",n).replace("{{days}}",r);return i.replace("{{coupon_code}}",'<span class="timer-coupon-code-'+o+'" style="color: '+o.coupon_code_color+'">'+t+"</span>").replace("{{coupon_timer}}",'<span id="rnoc-coupon-timer-'+o+'" style="color: '+o.coupon_timer_color+'">'+c+"</span>")},s=function(){var o=sessionStorage.getItem("rnoc_coupon_timer_started");1===parseInt(n.timer_reset)&&(o=(new Date).getTime(),sessionStorage.setItem("rnoc_coupon_timer_started",o.toString()),sessionStorage.removeItem("rnoc_timer_expired_message_shown"),e.post(n.reset_url,function(e,o){})),null===o||o===r?(o=(new Date).getTime(),sessionStorage.setItem("rnoc_coupon_timer_started",o.toString())):o=parseInt(o);var t=o+6e4*parseInt(n.time_in_minutes),s=n.code;""!==s&&(s=atob(s));var i=setInterval(function(){var o=(new Date).getTime(),c=t-o,_=Math.floor(c/864e5),p=Math.floor(c%864e5/36e5),l=Math.floor(c%36e5/6e4),u=Math.floor(c%6e4/1e3);if(c>0){if("yes"===n.top.enable)!function(o,t){var r="";"yes"===t.enable_cta&&(r='<a href="'+t.checkout_url+'" style="text-decoration:none;padding: 10px;color: '+t.cta_color+";background-color: "+t.cta_background+'">'+t.cta_text+"</a>");var n='<div class="rnoc-coupon-timer-container-top" style="'+t.display_on+":0;background-color:"+t.background+";color:"+t.color+';">'+o+r+"</div>";e(".rnoc-coupon-timer-container-top").remove();var a=e("body");a.prepend(n);var s=e(".rnoc-coupon-timer-container-top")[0];a.css("margin-"+t.display_on,s.offsetHeight)}(a(n.top,"top",s,_,p,l,u),n.top);if("yes"===n.above_cart.enable)!function(o,t){var r="";"yes"===t.enable_cta&&(r='<a href="'+t.checkout_url+'" style="text-decoration:none;padding: 10px;color: '+t.cta_color+";background-color: "+t.cta_background+'">'+t.cta_text+"</a>");var n='<div class="rnoc-coupon-timer-container-above_cart" style="background-color:'+t.background+";color:"+t.color+';">'+o+r+"</div>";e(".rnoc_before_cart_container").html(n)}(a(n.above_cart,"above_cart",s,_,p,l,u),n.above_cart);if("yes"===n.below_discount.enable){var d=a(n.below_discount,"below_discount",s,_,p,l,u);!function(o,t,r){var n='<div class="rnoc-coupon-timer-container-below_discount" style="background-color:'+r.background+";color:"+r.color+';">'+t+"</div>";e(".rnoc-below-discount_container-"+o).html(n)}(s,d,n.below_discount)}}else{clearInterval(i);var m=localStorage.getItem("rnoc_timer_expired_message_shown");m!==r&&null!==m&&1===parseInt(m)||(e.post(n.expiry_url,function(o,t){if(o.success){e(".rnoc-coupon-timer-container-top").remove(),e(".rnoc-coupon-timer-container-above_cart").remove(),e(".rnoc-coupon-timer-container-below_discount").remove(),e(".coupon-"+s.toLowerCase()).hide();var r=e(".woocommerce-notices-wrapper"),a='<ul class="woocommerce-error" role="alert"><li>'+n.expiry_message+"</li></ul>";r.append(a)}}),localStorage.setItem("rnoc_timer_expired_message_shown","1"))}},1e3)};"yes"===n.enable&&(1===parseInt(n.timer_started)&&s(),e(t).on("added_to_cart",function(e,o,t){s()}))},n.prototype.show_instant_popup=function(){var e=sessionStorage.getItem("rnoc_instant_coupon_is_redirected");if(e&&"no"===e){var t=sessionStorage.getItem("rnoc_instant_coupon_popup_redirect");sessionStorage.setItem("rnoc_instant_coupon_is_redirected","yes"),o.location.href=t}var r=sessionStorage.getItem("rnoc_instant_coupon_popup_showed");if(r&&"no"===r){var n=sessionStorage.getItem("rnoc_instant_coupon_popup_html");o.retainful.modal(n),sessionStorage.setItem("rnoc_instant_coupon_popup_showed","yes")}},n.prototype.init_atc_popup=function(r){var n=__assign(__assign({},this.default_atc_popup_settings),r),a=function(){if("yes"===n.enable){if("1"===sessionStorage.getItem("retainful_add_to_cart_popup_temporary_silent"))return sessionStorage.removeItem("retainful_add_to_cart_popup_temporary_silent"),!1;var e=sessionStorage.getItem("retainful_add_to_cart_popup_closed_by");if("1"===e)return!1;if(null===e)return!0;var o=!0;switch(n.show_popup_until){default:case"1":o="1"!==e;break;case"2":o="2"!==e;break;case"3":o="3"!==e}return o}},s=function(r){e(t).trigger("retainful_showing_add_to_cart_popup",[r]),r.removeClass("loading"),r.addClass("rnoc-popup-opener");var n=e(".atc-popup-content").html();o.retainful.modal('<div id="rnoc-add-to-cart-add-on">'+n+"</div>"),sessionStorage.setItem("retainful_add_to_cart_opened","yes"),e(t).trigger("retainful_showed_add_to_cart_popup",[r])};e(t).on("adding_to_cart",function(e,o,t){if(a())throw s(o),new Error("Retainful intercepts to show popup!");var r=localStorage.getItem("rnoc_atcp_data");null!=r&&""!==r&&(t.rnoc_email_popup=r,localStorage.removeItem("rnoc_atcp_data"))}),e(".ajax_add_to_cart,.single_add_to_cart_button "+n.custom_classes).on("click",function(o){if(a()&&!1===e(this).hasClass("disabled")&&!1===e(this).hasClass("acbwm-atcp-allow-click"))return o.preventDefault(),s(e(this)),!1;var t=localStorage.getItem("rnoc_atcp_data");if(null!=t&&""!==t){var r='<input type="hidden" name="rnoc_email_popup" value="'+t+'" />';e(this).after(r),localStorage.removeItem("rnoc_atcp_data")}}),e(t).on("before_rnoc_close_modal_atc_by_btn_click",function(){_("3")}),e(t).on("added_to_cart",function(e,t,r){o.retainful.show_instant_popup()}),e(t).on("click","#rnoc-add-to-cart-add-on .no-thanks-close-popup",function(e){e.preventDefault(),_("2")}),e(t).on("click","#rnoc-add-to-cart-add-on .rnoc-popup-btn",function(o){var t=e("#rnoc-add-to-cart-add-on #rnoc-popup-email-field").val(),r=e("#rnoc-add-to-cart-add-on  #rnoc-invalid-mail-message"),n=e("#rnoc-add-to-cart-add-on #rnoc-popup-buyer-accepts-marketing");i(t,n,e("#rnoc-add-to-cart-add-on .rnoc-popup-btn"),o,r)});var i=function(e,o,t,r,a){if(r.preventDefault(),a.hide(),"yes"===n.is_email_mandatory&&""===e)return a.show(),{error:!0};if(p(e)){t.addClass("loading"),t.attr("disabled",!0);var s={local_storage:!0,email:e,is_buyer_accepting_marketing:o.is(":checked")?1:0,action:"set_rnoc_guest_session"};localStorage.setItem("rnoc_atcp_data",e);var i=c(s);return i.error?i.message:(i.message,null!==i.redirect&&(sessionStorage.setItem("rnoc_instant_coupon_popup_redirect",i.redirect),sessionStorage.setItem("rnoc_instant_coupon_is_redirected","no")),i.show_coupon_instant_popup&&(sessionStorage.setItem("rnoc_instant_coupon_popup_showed","no"),sessionStorage.setItem("rnoc_instant_coupon_popup_html",i.coupon_instant_popup_content)),sessionStorage.setItem("rnocp_is_add_to_cart_popup_email_entered","1"),_("1")),t.removeClass("loading"),t.attr("disabled",!1),{error:!1}}return a.show(),{error:!0}},c=function(o,t,r,a,s){void 0===o&&(o={}),void 0===t&&(t={}),void 0===r&&(r="json"),void 0===a&&(a="POST"),void 0===s&&(s=!1);var i=null;return e.ajax({url:n.ajax_url,headers:t,method:a,dataType:r,data:o,async:s,success:function(e){i=e},error:function(e){i=e}}),i},_=function(r){void 0===r&&(r="1"),sessionStorage.setItem("retainful_add_to_cart_popup_closed_by",r);var a=e("rnoc-add-to-cart-add-on");e(t).trigger("retainful_closing_add_to_cart_popup",[a]);var s=e(".rnoc-popup-opener");"1"===r||"2"===r?(sessionStorage.setItem("retainful_add_to_cart_popup_temporary_silent","1"),s.click()):"just_close"!==n.close_btn_behavior&&(sessionStorage.setItem("retainful_add_to_cart_popup_temporary_silent","1"),s.click()),s.attr("disabled",!1),s.removeClass("rnoc-popup-opener"),"3"!==r&&o.retainful.close_modal(),e(t).trigger("retainful_closed_add_to_cart_popup",[a])},p=function(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)}},n.prototype.init_ei_popup=function(n){o.rnoc_ei_popup_showed_for=0,o.rnoc_ei_popup_is_active=!1,o.is_rnoc_mobil_scroll_popup_showed=!1;var a=__assign(__assign({},this.default_ei_popup_settings),n),s=function(){var t;for(var n in sessionStorage)if(sessionStorage.hasOwnProperty(n)&&0===n.indexOf("wc_cart_hash_")){t=sessionStorage.getItem(n);break}if(e("form.checkout").is(".processing"))return!1;if(""!==t&&t!==r&&null!==t){var s=!1;switch(a.show_for){default:case"all":s=!0;break;case"guest":s="no"===a.is_user_logged_in;break;case"non_email_users":var i=sessionStorage.getItem("rnocp_is_add_to_cart_popup_email_entered");s=void 0!==i||0===parseInt(i)}if(!s)return!1;if(s&&!1===o.rnoc_ei_popup_is_active){var c=e(".rnoc-ei-popup").html();o.retainful.modal(c,"ei"),o.rnoc_ei_popup_is_active=!0,sessionStorage.setItem("rnoc_ei_popup_showed_count","1"),o.rnoc_ei_popup_showed_for++}switch(a.show_popup){default:case"every_time_on_customer_exists":s=!0;break;case"once_per_page":s=o.rnoc_ei_popup_showed_for<=1;break;case"show_x_times_per_page":s=o.rnoc_ei_popup_showed_for<=parseInt(a.number_of_times_per_page);break;case"once_per_session":s=void 0!==sessionStorage.getItem("rnoc_ei_popup_showed_count")}}};"yes"===a.enable&&(e(t).on("submit","#rnoc_exit_intent_popup_form",function(t){t.preventDefault();var r=e(this).find(".rnoc-exit-intent-popup-submit-button"),n=e(this).find("#rnoc-invalid-mail-message-exit-intent"),s=e(this).find("#rnoc-exit-intent-popup-email-field");console.log(s.val());var i=e("#rnoc-exit-intent-popup-buyer-accepts-marketing");if(n.hide(),!function(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)}(s.val())||""===s.val())return n.show(),!1;r.addClass("loading"),r.attr("disabled",!0);var c={email:s.val(),is_buyer_accepting_marketing:i.is(":checked")?1:0,action:"set_rnoc_exit_intent_popup_guest_session"};e.post(a.ajax_url,c,function(e){!1===e.error?(sessionStorage.setItem("rnocp_is_add_to_cart_popup_email_entered","1"),""!==e.message&&alert(e.message),o.retainful.close_modal(),e.redirect&&(o.location.href=e.redirect)):""!==e.message&&alert(e.message),r.removeClass("loading"),r.attr("disabled",!1)})}),e(t).on("mouseleave",function(e){e.clientY<0&&s()}),screen.width<768&&("yes"===a.mobile.time_delay&&parseInt(a.mobile.delay)>0&&setTimeout(function(){s()},1e3*parseInt(a.mobile.delay)),"yes"===a.mobile.scroll_distance&&parseInt(a.mobile.distance)>0&&e(o).on("scroll",function(){var r,n,i,c;(r=e(o).height(),n=e(t).height(),i=e(o).scrollTop(),c=n-r,Math.floor(i/c*100))>a.mobile.distance&&!1===o.is_rnoc_mobil_scroll_popup_showed&&(o.is_rnoc_mobil_scroll_popup_showed=!0,s())})))},o.retainful=new n,o.retainful.is_local_storage_supported()&&e(t).ready(function(){o.retainful.init_ei_popup(rnoc_premium_ei_popup),o.retainful.init_coupon_timer(rnoc_premium_ct),o.retainful.init_atc_popup(rnoc_premium_atcp),o.retainful.show_instant_popup()})});