"use strict";!function(t){var i=new(function(){function i(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.end_point=t,this.public_key=i,this.abandoned_cart_data=null,this.cart_hash=null,this.cart_tracking_element_id="retainful-abandoned-cart-data",this.async_request=!0,this.previous_cart_hash=null}return i.prototype.setEndPoint=function(t){return this.end_point=t,this},i.prototype.getEndPoint=function(){return this.end_point},i.prototype.setPublicKey=function(t){return this.public_key=t,this},i.prototype.getPublicKey=function(){return this.public_key},i.prototype.setCartTrackingElementId=function(t){return this.cart_tracking_element_id=t,this},i.prototype.getCartTrackingElementId=function(){return this.cart_tracking_element_id},i.prototype.setAbandonedCartData=function(i){if(void 0===i&&(i=null),null!==i)this.abandoned_cart_data=i;else{var n=this.getCartTrackingElementId(),a=t("#"+n).html(),e=JSON.parse(a);this.abandoned_cart_data=e.data,this.cart_hash=e.cart_hash}return this},i.prototype.getAbandonedCartData=function(){return this.setAbandonedCartData(),this.abandoned_cart_data},i.prototype.getCartHash=function(){return this.cart_hash},i.prototype.initCartTracking=function(){var i=this;return t(document.body).on("added_to_cart removed_from_cart updated_cart_totals updated_shipping_method applied_coupon removed_coupon updated_checkout",function(){i.syncCart()}).on("wc_fragments_refreshed",function(){i.syncCart()}).on("wc_fragments_loaded",function(){i.syncCart()}),this},i.prototype.syncCart=function(t,i){void 0===t&&(t=null),void 0===i&&(i=!1),null===t&&(t=this.getAbandonedCartData());var n=this.getCartHash();if(null!=t&&""!==t&&n!==this.previous_cart_hash||i){this.previous_cart_hash=n;var a={app_id:this.getPublicKey(),"Content-Type":"application/json"},e={data:t};this.request(this.getEndPoint(),JSON.stringify(e),a,"json","POST",this.async_request)}},i.prototype.request=function(i,n,a,e,r,s){void 0===n&&(n={}),void 0===a&&(a={}),void 0===e&&(e="json"),void 0===r&&(r="POST"),void 0===s&&(s=!1);var l=null;return t.ajax({url:i,headers:a,method:r,dataType:e,data:n,async:s,success:function(t){l=t},error:function(t){l=t}}),l},i}())(retainful_cart_data.api_url,retainful_cart_data.public_key).setCartTrackingElementId(retainful_cart_data.tracking_element_selector);"js"===retainful_cart_data.cart_tracking_engine&&i.initCartTracking(),t("input#billing_email,input#billing_last_name,input#billing_first_name,input#billing_postcode,select#billing_country,select#billing_state").on("change",function(){if(""!==t("#billing_email").val()){var n=t("#ship-to-different-address-checkbox:checked").length,a={billing_first_name:t("#billing_first_name").val(),billing_last_name:t("#billing_last_name").val(),billing_company:t("#billing_company").val(),billing_address_1:t("#billing_address_1").val(),billing_address_2:t("#billing_address_2").val(),billing_city:t("#billing_city").val(),billing_state:t("#billing_state").val(),billing_postcode:t("#billing_postcode").val(),billing_country:t("#billing_country").val(),billing_phone:t("#billing_phone").val(),billing_email:t("#billing_email").val(),ship_to_billing:n,order_notes:t("#order_comments").val(),shipping_first_name:t("#shipping_first_name").val(),shipping_last_name:t("#shipping_last_name").val(),shipping_company:t("#shipping_company").val(),shipping_address_1:t("#shipping_address_1").val(),shipping_address_2:t("#shipping_address_2").val(),shipping_city:t("#shipping_city").val(),shipping_state:t("#shipping_state").val(),shipping_postcode:t("#shipping_postcode").val(),shipping_country:t("#shipping_country").val(),action:"rnoc_track_user_data"},e=i.request(retainful_cart_data.ajax_url,a,{},"json","POST",!1);e.success&&e.data&&i.syncCart(e.data,!0)}})}(jQuery);