"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var o,e=1,n=arguments.length;e<n;e++)for(var r in o=arguments[e])Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);return t}).apply(this,arguments)};function initJqueryRetainfulPopupJs(){jQuery(function(t){var o=(new(function(){function o(){this.add_to_cart_popup_options={}}return o.prototype.isLocalStorageSupports=function(){try{return sessionStorage.setItem("retainful","test"),sessionStorage.removeItem("retainful"),localStorage.setItem("retainful","test"),localStorage.removeItem("retainful"),!0}catch(t){return!1}},o.prototype.setOptions=function(t){void 0===t&&(t={});return this.add_to_cart_popup_default_options=__assign(__assign({},{enable_add_to_cart_popup:"no",is_email_mandatory:"yes",no_thanks_action:"1",close_btn_behavior:"just_close",show_popup_until:"1",add_to_cart_popup_base_id:"#rnoc-add-to-cart-add-on"}),t),this},o.prototype.getOptions=function(){return this.add_to_cart_popup_default_options},o.prototype.displayPopup=function(o){t(document).trigger("retainful_showing_add_to_cart_popup",[o]),o.removeClass("loading"),o.addClass("rnoc-popup-opener");var e=this.getAddToCartPopupWindow();e.css("display","block"),sessionStorage.setItem("retainful_add_to_cart_opened","yes"),t(document).trigger("retainful_showed_add_to_cart_popup",[e,o])},o.prototype.closePopup=function(o){if(void 0===o&&(o="1"),this.isLocalStorageSupports()){sessionStorage.setItem("retainful_add_to_cart_popup_closed_by",o);var e=this.getAddToCartPopupWindow();t(document).trigger("retainful_closing_add_to_cart_popup",[e]);var n=t(".rnoc-popup-opener");"1"===o||"2"===o?(sessionStorage.setItem("retainful_add_to_cart_popup_temporary_silent","1"),n.click()):"just_close"!==this.getCloseButtonBehaviour()&&(sessionStorage.setItem("retainful_add_to_cart_popup_temporary_silent","1"),n.click()),n.attr("disabled",!1),n.removeClass("rnoc-popup-opener"),e.css("display","none"),t(document).trigger("retainful_closed_add_to_cart_popup",[e])}},o.prototype.getAddToCartPopupWindow=function(){var o=this.getOptions();return t(o.add_to_cart_popup_base_id)},o.prototype.getCloseButtonBehaviour=function(){return this.getOptions().close_btn_behavior},o.prototype.isPopupEnabled=function(){return"yes"===this.getOptions().enable_add_to_cart_popup},o.prototype.isEmail=function(t){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)},o.prototype.needPopup=function(){var t=this.getOptions();if(this.isLocalStorageSupports()&&this.isPopupEnabled()){if("1"===sessionStorage.getItem("retainful_add_to_cart_popup_temporary_silent"))return sessionStorage.removeItem("retainful_add_to_cart_popup_temporary_silent"),!1;var o=sessionStorage.getItem("retainful_add_to_cart_popup_closed_by");if("1"===o)return!1;if(null===o)return!0;var e=!0;switch(t.show_popup_until){default:case"1":e="1"!==o;break;case"2":e="2"!==o;break;case"3":e="3"!==o}return e}return!1},o.prototype.request=function(o,e,n,r,a,s){void 0===e&&(e={}),void 0===n&&(n={}),void 0===r&&(r="json"),void 0===a&&(a="POST"),void 0===s&&(s=!1);var i=null;return t.ajax({url:o,headers:n,method:a,dataType:r,data:e,async:s,success:function(t){i=t},error:function(t){i=t}}),i},o.prototype.syncEmail=function(t,o,e,n,r){if(n.preventDefault(),r.hide(),"yes"===this.getOptions().is_email_mandatory&&""===t)return r.show(),{error:!0};if(this.isEmail(t)){e.addClass("loading"),e.attr("disabled",!0);var a={local_storage:!0,email:t,is_buyer_accepting_marketing:o.is(":checked")?1:0,action:"set_rnoc_guest_session"},s=this.request(rnoc_ajax_url,a);return s.error?s.message:(s.message,null!==s.redirect&&(sessionStorage.setItem("rnoc_instant_coupon_popup_redirect",s.redirect),sessionStorage.setItem("rnoc_instant_coupon_is_redirected","no")),s.show_coupon_instant_popup&&(sessionStorage.setItem("rnoc_instant_coupon_popup_showed","no"),sessionStorage.setItem("rnoc_instant_coupon_popup_html",s.coupon_instant_popup_content)),sessionStorage.setItem("rnocp_is_add_to_cart_popup_email_entered","1"),this.closePopup("1")),e.removeClass("loading"),e.attr("disabled",!1),{error:!1}}return r.show(),{error:!0}},o}())).setOptions(retainful_premium_add_to_cart_collection_popup_condition);if(t(document).on("adding_to_cart",function(t,e){if(o.needPopup())throw o.displayPopup(e),new Error("Retainful intercepts to show popup!")}),t(document).on("click","#rnoc-add-to-cart-add-on .close-rnoc-popup",function(t){t.preventDefault(),o.closePopup("3")}),t(document).on("click","#rnoc-add-to-cart-add-on .no-thanks-close-popup",function(t){t.preventDefault(),o.closePopup("2")}),t(document).on("click","#rnoc-add-to-cart-add-on .rnoc-popup-btn",function(e){var n=t("#rnoc-add-to-cart-add-on #rnoc-popup-email-field").val(),r=t("#rnoc-add-to-cart-add-on  #rnoc-invalid-mail-message"),a=t("#rnoc-add-to-cart-add-on #rnoc-popup-buyer-accepts-marketing");o.syncEmail(n,a,t("#rnoc-add-to-cart-add-on .rnoc-popup-btn"),e,r)}),t(document).on("click",".single_add_to_cart_button,[name=add-to-cart]",function(e){o.needPopup()&&(e.preventDefault(),o.displayPopup(t(this)))}),"undefined"!=typeof retainful_premium_add_to_cart_collection&&void 0!==retainful_premium_add_to_cart_collection.add_to_cart_button_classes){var e=retainful_premium_add_to_cart_collection.add_to_cart_button_classes;t(document).on("click",e,function(e){var n=t(this),r=n.attr("href"),a=n.attr("name");void 0!==r&&o.needPopup()&&-1!==r.indexOf("add-to-cart")?(e.preventDefault(),o.displayPopup(n)):void 0!==a&&"add-to-cart"===a&&(e.preventDefault(),o.displayPopup(n))})}var n=new(function(){function o(){}return o.prototype.isLocalStorageSupports=function(){try{return sessionStorage.setItem("retainful","test"),sessionStorage.removeItem("retainful"),localStorage.setItem("retainful","test"),localStorage.removeItem("retainful"),!0}catch(t){return!1}},o.prototype.showInstantPopup=function(){if(this.isLocalStorageSupports()){var o=sessionStorage.getItem("rnoc_instant_coupon_is_redirected");if(o&&"no"===o){var e=sessionStorage.getItem("rnoc_instant_coupon_popup_redirect");sessionStorage.setItem("rnoc_instant_coupon_is_redirected","yes"),window.location.href=e}var n=sessionStorage.getItem("rnoc_instant_coupon_popup_showed");if(n&&"no"===n){var r=sessionStorage.getItem("rnoc_instant_coupon_popup_html");t(r).appendTo("body"),this.getInstantPopup().show(),sessionStorage.setItem("rnoc_instant_coupon_popup_showed","yes")}}},o.prototype.closeInstantPopup=function(){this.getInstantPopup().hide()},o.prototype.getInstantPopup=function(){return t("#rnoc-add-to-cart-add-on-instant-coupon").show()},o}());t(document).on("added_to_cart",function(t,o,e){n.showInstantPopup()}),t(document).ready(function(){n.showInstantPopup()}),t(document).on("click","#rnoc-add-to-cart-add-on-instant-coupon .close-rnoc-popup",function(){n.closeInstantPopup()})})}document.addEventListener("DOMContentLoaded",function(){if("undefined"==typeof jQuery){void 0!==retainful_premium_add_to_cart_collection_popup_condition.jquery_url&&function(t,o){var e=document.createElement("script");e.src=t;var n=document.getElementsByTagName("head")[0],r=!1;e.onload=e.onreadystatechange=function(){r||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(r=!0,o(),e.onload=e.onreadystatechange=null,n.removeChild(e))},n.appendChild(e)}(retainful_premium_add_to_cart_collection_popup_condition.jquery_url,function(){"undefined"==typeof jQuery||(jQuery.noConflict(),initJqueryRetainfulPopupJs())})}else initJqueryRetainfulPopupJs()});